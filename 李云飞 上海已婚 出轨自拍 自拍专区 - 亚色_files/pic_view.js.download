var tabscontentTop = $(".video-likes-comment").offset().top - 200;
var app = new Vue({
    el: '#app',
    delimiters: ['${', '}'],
    data: {
        LikeList: [],
        LikeNum: 0,
        LikePage: 1,
        CommentList: [],
        CommentNum: 0,
        CommentTotal: 0,
        CommentPage: 1,
        Getcomment: false,
        Getlike: false,
        UserLike: false,
        Follow: {},
        Info: info,
        CommentIng: false
    },
    mounted:function(){
        if($app){
            $("a.logo").html("<i class=\"icon icon-angle-left\"></i>").attr("href","javascript:void(0);").click(function(){
                history.back()
            })
        }
    },
    methods: {
        sendComment: function(e){
            obj = e.currentTarget
            var pid = $(obj).attr("data-pid");
            var puid = $(obj).attr("data-puid");
            var pname = $(obj).attr("data-pname");
            this.CommentReplay  = {
                Pid: pid,
                Puid: puid,
                Pname: pname
            }
            this.CommentIng = true
            this.$nextTick(function(){
                $("input[name='comment']").focus()
            })
        },
        CommentOnblur: function(e){
            commentOnBlur(e, this)
        },
        postComment: function(){
            var that = this
            postComment(that)
        },
        getCommentList: ()=>{
            app.Getcomment = true;
            $(".loading-comment-btn").toggleClass('loading');
            $.get("/api/comment/list?type="+app.Info.type+"&tid="+app.Info.id+"&page="+app.CommentPage, function(res){
                $(".loading-comment-btn").toggleClass('loading');
                if(res.code === 1){
                    $('#commentListLoading').hide();
                    $('#commentList').show();
                    res.data.list.forEach(function(item, key){
                        app.CommentList.push(item)
                    });
                    app.CommentNum = res.data.total;
                    app.Info.commentnum = res.data.total;
                    app.CommentTotal = res.data.comment_num;
                    app.CommentPage = res.data.page + 1;
                }
            })
        },
        getLike: () => {
            $(".loading-like-btn").toggleClass('loading');
            $.get("/api/pic/like_pic?id="+app.Info.id+"&page="+app.LikePage, function(res){
                app.Getlike = true;
                $(".loading-like-btn").toggleClass('loading');
                if(res.code === 1){
                    $('#likeListLoading').hide();
                    $('#likeList').show();
                    res.data.list.forEach(function(item, key){
                        app.LikeList.push(item)
                    });
                    app.LikeNum = res.data.total;
                    app.LikePage = res.data.page + 1;
                }
            });
        },
        getUserLike: () => {
            getUserLike();
        },
        goTop: () => {
            $('body,html').animate({ scrollTop: 0 }, 0);
        }
    }
});
app.getLike();
app.getUserLike();
app.getCommentList();